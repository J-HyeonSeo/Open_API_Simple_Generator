# Trouble Shooting
프로젝트를 진행하면서 발생한 문제점을 정리하고,
이에 대한 해결책을 정리하는 문서입니다.

---

### 1. MongoDB Index 오류


문제 상황
- MongoDB에 인덱스를 생성하려고 하는데, 인덱스 생성이 되지 않는 오류가 발생함.

문제 원인
- MongoDB의 Collection에는 하나의 text-index(full-text-search-index)만 가질 수 있다고 명시됨.

해결 방안
- https://www.mongodb.com/docs/manual/core/indexes/index-types/index-text/
- 텍스트인덱스는 컬렉션당 하나지만, 하나의 인덱스에 복합인덱스로 구성하면 여러개가 사용가능하다고 함.
- 이를 참조하여, 다중 조건 검색에도 유리하게, 복합인덱스로 생성하도록 구성함.

---

### 2. MongoDB 인덱스 사용 여부


문제 상황
- text를 위해 복합인덱스로 생성하였지만, 해당 조합의 쿼리를 날리는 경우에 사용이 가능하다.
- 해당 프로젝트는 원하는 필드별로 각각 쿼리를 날리는 경우가 발생하므로 적합하지 않다고 판단함.

해결 방안
- INCLUDE를 수행하는 필드만 묶어서 text 인덱스를 사용하도록 설정함.
- text 인덱스끼리 있을 경우에는, 필드 순서에 상관없이 해당 단어만 포함되도 검색대상에 포함되는걸 알 수 있음.
- 단, 특정 필드에 대한 검색일수도 있으므로, 질의시에는 검색 필드명에 대해 or연산으로 다시 한 번 처리가 필요해보임.
- text를 제외한 나머지 필드들은 오름차 정렬 인덱스로 각각 따로 생성하는 것으로 구성하기로 함.